{"componentChunkName":"component---src-templates-blog-post-js","path":"/writings/electron-mac-app-store-sign/","result":{"data":{"site":{"siteMetadata":{"title":"KWGUO Blog"}},"markdownRemark":{"id":"3e09beaa-ff4d-58be-956b-219ce508b017","excerpt":"最近被公司叫去寫個 electron 的專案，今天來記錄一下再處理 mac app sign 的問題。 眾所皆知，apple 是一間很龜毛的公司，最作為一個開發者，當想要上架程式到 app store 或者是 mac app store，都會是一段痛苦的經驗， app store 有個麻煩的審核流程，而 mac app…","html":"<p>最近被公司叫去寫個 electron 的專案，今天來記錄一下再處理 mac app sign 的問題。</p>\n<p>眾所皆知，apple 是一間很龜毛的公司，最作為一個開發者，當想要上架程式到 app store 或者是 mac app store，都會是一段痛苦的經驗， app store 有個麻煩的審核流程，而 mac app store 更是有過之而無不及，除了審核流程以外，sign 流程更是痛苦。</p>\n<p>在把程式上架到 mac app store(mas) 之前，我們需要兩個 certificate （<code class=\"language-text\">3rd Party Mac Developer Application: XXXXXXX (XXXXXX)</code>, <code class=\"language-text\">3rd Party Mac Developer Installer: XXXXXXX (XXXXXX)</code>） 跟一個 provisioning profile。</p>\n<p>我們會透過 <a href=\"https://github.com/electron-userland/electron-builder\">electron-builder</a> 來 build 我們的 electron app，下面是一個基本的 electron build config for mas build。</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"appId\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"my.app.id\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"mac\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token property\">\"identity\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"XXXXXXX (XXXXXX)\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"type\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"distribution\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"target\"</span><span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"mas\"</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"entitlements\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./entitlements.plist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"entitlementsInherit\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./entitlements.inherit.plist\"</span><span class=\"token punctuation\">,</span>\n    <span class=\"token property\">\"provisioningProfile\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"./MY.provisionprofile\"</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>透過這個<a href=\"https://www.electron.build/configuration/mac\">文件</a>，我們可以知道 target 中有 <code class=\"language-text\">mas</code> &#x26; <code class=\"language-text\">mas-dev</code>，這兩個到底差在哪裡？這就到我開發的時候遇到的問題了。</p>\n<p>其實我們不能執行 distribution-signed 的 app， mac app store 會 re-signed 一次讓所有人的 mac 都能安裝這個檔案，我們能做的就是自己用 <code class=\"language-text\">Developer ID: XXXXXXX (XXXXX)</code> certificate resign，這就是 <code class=\"language-text\">mas-dev</code> 的功能，他會幫我們 resign app ，好讓我們可以測試這個東西是不是可以正常運作。</p>\n<p>因為我是花了很多時間在上面，才知道我們是沒辦法測試 distribution-signed app 的，才在這邊紀錄一下，避免以後忘記，因為 iOS 就可以直接測試，再不然也有 TestFlight ，誰知道 mac app store 沒有這種東西 =_=</p>\n<h2>References</h2>\n<ul>\n<li><a href=\"https://www.electron.build/code-signing#how-to-export-certificate-on-macos\">https://www.electron.build/code-signing#how-to-export-certificate-on-macos</a></li>\n<li><a href=\"https://developer.apple.com/forums/thread/651943\">https://developer.apple.com/forums/thread/651943</a></li>\n</ul>","frontmatter":{"title":"Electron mac app store sign","tags":["writing","mac app store","mas","electron","sign","deployment"],"date":"September 07, 2020","description":"If didn't works don't surprise"}}},"pageContext":{"slug":"/electron-mac-app-store-sign/","previous":{"fields":{"slug":"/createobjecturl/"},"frontmatter":{"title":"URL.createObjectURL","tags":["writing","web","download","blob","file"]}},"next":{"fields":{"slug":"/testable-code/"},"frontmatter":{"title":"Testable code","tags":["writing","test","golang","code quality"]}}}},"staticQueryHashes":["4111554205","63159454"]}